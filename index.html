<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ë§Œì˜ ê³„ì ˆ ê°€ì¡± ì‚¬ë‘ ì—½ì„œ ë§Œë“¤ê¸° ğŸŒ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Malgun Gothic", "ë§‘ì€ ê³ ë”•", "Apple SD Gothic Neo", sans-serif;
        }
        
        /* ê³„ì ˆë³„ ì—½ì„œ í…Œë§ˆ ìŠ¤íƒ€ì¼ */
        .season-spring {
            background: linear-gradient(135deg, #fce7f3, #f3e8ff, #ecfdf5);
            border: 5px solid #f9a8d4;
        }
        .season-spring .theme-icon { color: #ec4899; }
        .season-spring .recipient-sender-text { color: #be185d; }

        .season-summer {
            background: linear-gradient(135deg, #dbeafe, #e0f2fe, #ecfeff);
            border: 5px solid #38bdf8;
        }
        .season-summer .theme-icon { color: #0284c7; }
        .season-summer .recipient-sender-text { color: #075985; }

        .season-autumn {
            background: linear-gradient(135deg, #fed7aa, #fecaca, #fef3c7);
            border: 5px solid #fb923c;
        }
        .season-autumn .theme-icon { color: #ea580c; }
        .season-autumn .recipient-sender-text { color: #c2410c; }
        
        .season-winter {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0, #f8fafc);
            border: 5px solid #94a3b8;
        }
        .season-winter .theme-icon { color: #475569; }
        .season-winter .recipient-sender-text { color: #334155; }
        
        /* ê³„ì ˆ ì„ íƒ ìƒíƒœ í‘œì‹œ */
        .season-option.selected {
            border-color: currentColor;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        /* ğŸŒ¸ ë´„ - ê½ƒì í©ë‚ ë¦¬ê¸° ì• ë‹ˆë©”ì´ì…˜ */
        .spring-petals {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .petal {
            position: absolute;
            width: 12px;
            height: 12px;
            background: radial-gradient(ellipse, #fce7f3, #f9a8d4);
            border-radius: 50% 0;
            opacity: 0.7;
            animation: petalFall linear infinite;
        }
        
        @keyframes petalFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* ğŸŒŠ ì—¬ë¦„ - íŒŒë„ ì• ë‹ˆë©”ì´ì…˜ */
        .summer-waves {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .wave {
            position: absolute;
            bottom: 0;
            left: -50%;
            width: 200%;
            height: 40px;
            background: linear-gradient(90deg, transparent, rgba(56, 189, 248, 0.3), transparent);
            border-radius: 50%;
            animation: waveMove linear infinite;
        }
        
        @keyframes waveMove {
            0% {
                transform: translateX(-50%) scaleY(1);
            }
            50% {
                transform: translateX(-25%) scaleY(1.2);
            }
            100% {
                transform: translateX(0%) scaleY(1);
            }
        }
        
        /* ğŸ‚ ê°€ì„ - ë‚™ì—½ ë–¨ì–´ì§€ê¸° ì• ë‹ˆë©”ì´ì…˜ */
        .autumn-leaves {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .leaf {
            position: absolute;
            font-size: 16px;
            opacity: 0.8;
            animation: leafFall linear infinite;
        }
        
        @keyframes leafFall {
            0% {
                transform: translateY(-50px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(180deg);
                opacity: 0;
            }
        }
        
        /* â„ï¸ ê²¨ìš¸ - ëˆˆ ë‚´ë¦¬ê¸° ì• ë‹ˆë©”ì´ì…˜ */
        .winter-snow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .snowflake {
            position: absolute;
            color: white;
            font-size: 14px;
            opacity: 0.9;
            animation: snowFall linear infinite;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
        }
        
        @keyframes snowFall {
            0% {
                transform: translateY(-50px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.9;
            }
            90% {
                opacity: 0.9;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* ì—½ì„œ ì½˜í…ì¸ ëŠ” ì• ë‹ˆë©”ì´ì…˜ë³´ë‹¤ ìœ„ì— í‘œì‹œ */
        .postcard-content {
            position: relative;
            z-index: 10;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .postcard-text-layer {
            position: relative;
            z-index: 10;
        }
        
        .loading {
            pointer-events: none;
            opacity: 0.7;
        }
        
        /* ìŠ¤í¬ë¦° ë¦¬ë” ì „ìš© í…ìŠ¤íŠ¸ */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-100 via-purple-50 to-sky-100 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="container mx-auto max-w-4xl bg-white shadow-2xl rounded-xl p-4 sm:p-6 md:p-8">
        <header class="text-center mb-6 sm:mb-8">
            <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-sky-500">ğŸŒ¸ ë‚˜ë§Œì˜ ê³„ì ˆ ê°€ì¡± ì‚¬ë‘ ì—½ì„œ ğŸŒ¸</h1>
            <p class="text-slate-600 mt-2 sm:mt-3 text-sm md:text-base">ì†Œì¤‘í•œ ê°€ì¡±ì—ê²Œ ì‚¬ë‘í•˜ëŠ” ë§ˆìŒì„ ë‹´ì•„ ê³„ì ˆì˜ ì•„ë¦„ë‹¤ì›€ê³¼ í•¨ê»˜ ì„¸ìƒì— í•˜ë‚˜ë¿ì¸ ì—½ì„œë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 md:gap-8">
            <div class="bg-slate-50 p-4 sm:p-6 rounded-lg shadow-md">
                <!-- ê³„ì ˆ í…Œë§ˆ ì„ íƒ -->
                <div class="mb-6 sm:mb-8">
                    <h2 class="text-lg sm:text-xl font-semibold text-slate-700 mb-4">ğŸŒˆ ê³„ì ˆ í…Œë§ˆë¥¼ ì„ íƒí•´ë³´ì„¸ìš”!</h2>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                        <button id="seasonSpring" class="season-option flex flex-col items-center p-3 rounded-xl border-2 border-transparent hover:border-pink-400 transition-all duration-200 bg-pink-100" data-season="spring">
                            <span class="text-3xl mb-1">ğŸŒ¸</span>
                            <span class="text-sm font-medium text-pink-700">ë´„</span>
                            <span class="text-xs text-pink-600">ê½ƒì í©ë‚ ë¦¼</span>
                        </button>
                        <button id="seasonSummer" class="season-option flex flex-col items-center p-3 rounded-xl border-2 border-transparent hover:border-blue-400 transition-all duration-200 bg-blue-100" data-season="summer">
                            <span class="text-3xl mb-1">ğŸŒŠ</span>
                            <span class="text-sm font-medium text-blue-700">ì—¬ë¦„</span>
                            <span class="text-xs text-blue-600">íŒŒë„ ì›€ì§ì„</span>
                        </button>
                        <button id="seasonAutumn" class="season-option flex flex-col items-center p-3 rounded-xl border-2 border-transparent hover:border-orange-400 transition-all duration-200 bg-orange-100" data-season="autumn">
                            <span class="text-3xl mb-1">ğŸ‚</span>
                            <span class="text-sm font-medium text-orange-700">ê°€ì„</span>
                            <span class="text-xs text-orange-600">ë‚™ì—½ ë–¨ì–´ì§</span>
                        </button>
                        <button id="seasonWinter" class="season-option flex flex-col items-center p-3 rounded-xl border-2 border-transparent hover:border-gray-400 transition-all duration-200 bg-gray-100" data-season="winter">
                            <span class="text-3xl mb-1">â„ï¸</span>
                            <span class="text-sm font-medium text-gray-700">ê²¨ìš¸</span>
                            <span class="text-xs text-gray-600">ëˆˆ ë‚´ë¦¼</span>
                        </button>
                    </div>
                </div>

                <h3 class="text-xl sm:text-2xl font-semibold text-slate-700 mb-4 sm:mb-6">âœï¸ ì—½ì„œ ë‚´ìš© ì…ë ¥í•˜ê¸°</h3>
                <div class="space-y-4">
                    <div>
                        <label for="recipient" class="block text-sm font-medium text-slate-700">ğŸ’Œ ë°›ëŠ” ì‚¬ëŒ:</label>
                        <input type="text" id="recipient" name="recipient" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500 sm:text-sm" placeholder="ì˜ˆ: ì‚¬ë‘í•˜ëŠ” ì—„ë§ˆ ì•„ë¹ ê»˜">
                    </div>
                    <div>
                        <label for="sender" class="block text-sm font-medium text-slate-700">âœï¸ ë³´ë‚´ëŠ” ì‚¬ëŒ:</label>
                        <input type="text" id="sender" name="sender" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500 sm:text-sm" placeholder="ì˜ˆ: ê·€ì—¼ë‘¥ì´ OOO ì˜¬ë¦¼">
                    </div>
                    <div>
                        <label for="message" class="block text-sm font-medium text-slate-700">ğŸ’• ì‚¬ë‘ì˜ ë©”ì‹œì§€:</label>
                        <textarea id="message" name="message" rows="5" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500 sm:text-sm" placeholder="ê°€ì¡±ì—ê²Œ ì „í•˜ê³  ì‹¶ì€ ë”°ëœ»í•œ ë§ˆìŒì„ ììœ ë¡­ê²Œ ì ì–´ë³´ì„¸ìš”."></textarea>
                    </div>
                    <div>
                        <label for="promise" class="block text-sm font-medium text-slate-700">ğŸ¤ ê°€ì¡±ì„ ìœ„í•´ ë‚´ê°€ ê¼­ ì‹¤ì²œí•  ì•½ì†:</label>
                        <textarea id="promise" name="promise" rows="3" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500 sm:text-sm" placeholder="ì˜ˆ: ë¶€ëª¨ë‹˜ ë§ì”€ ì˜ ë“£ê³ , ë™ìƒê³¼ ì‚¬ì´ì¢‹ê²Œ ì§€ë‚´ê¸°"></textarea>
                    </div>
                    <div>
                        <label for="date" class="block text-sm font-medium text-slate-700">ğŸ“… ì‘ì„± ë‚ ì§œ:</label>
                        <input type="date" id="date" name="date" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500 sm:text-sm">
                    </div>
                </div>

                <div class="mt-6 sm:mt-8 space-y-3">
                    <button id="updatePreview" class="w-full flex items-center justify-center bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-4 rounded-md shadow transition-colors duration-150 text-sm sm:text-base"><span class="mr-2 text-lg">ğŸ¨</span>ì—½ì„œ í™•ì¸í•˜ê¸°</button>
                    
                    <button id="downloadImageBtn" class="w-full flex items-center justify-center bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-md shadow transition-colors duration-150 text-sm sm:text-base">
                        <span class="mr-2 text-lg">ğŸ“¸</span>ì—½ì„œ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°
                    </button>
                    
                    <button id="copyContent" class="w-full flex items-center justify-center bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-4 rounded-md shadow transition-colors duration-150 text-sm sm:text-base"><span class="mr-2 text-lg">ğŸ“‹</span>ë‚´ìš© ì „ì²´ ë³µì‚¬</button>
                    <button id="resetForm" class="w-full flex items-center justify-center bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-md shadow transition-colors duration-150 text-sm sm:text-base"><span class="mr-2 text-lg">ğŸ”„</span>ìƒˆë¡œ ì“°ê¸°</button>
                </div>
                
                <!-- ìƒíƒœ ë©”ì‹œì§€ ì˜ì—­ -->
                <div id="status-messages" aria-live="polite" aria-atomic="true" class="sr-only"></div>
            </div>

            <div class="bg-slate-50 p-4 sm:p-6 rounded-lg shadow-md flex flex-col">
                <h2 class="text-xl sm:text-2xl font-semibold text-slate-700 mb-4 sm:mb-6 text-center">âœ¨ ì™„ì„±ëœ ì—½ì„œ ë¯¸ë¦¬ë³´ê¸° âœ¨</h2>
                <div id="postcardPreview" class="season-spring w-full min-h-[400px] sm:min-h-[500px] p-4 sm:p-6 rounded-lg shadow-inner flex flex-col transition-all duration-300 ease-in-out relative overflow-hidden">
                    
                    <!-- ê³„ì ˆë³„ ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ ì˜ì—­ë“¤ -->
                    <div id="springPetals" class="spring-petals"></div>
                    <div id="summerWaves" class="summer-waves" style="display: none;"></div>
                    <div id="autumnLeaves" class="autumn-leaves" style="display: none;"></div>
                    <div id="winterSnow" class="winter-snow" style="display: none;"></div>
                    
                    <!-- í…ìŠ¤íŠ¸ ë ˆì´ì–´ (ì• ë‹ˆë©”ì´ì…˜ ìœ„ì— í‘œì‹œ) -->
                    <div class="postcard-text-layer flex flex-col h-full">
                        <div class="absolute top-2 right-2 sm:top-4 sm:right-4 text-2xl sm:text-4xl theme-icon" id="previewThemeIcon">ğŸŒ¸</div>
                        
                        <div class="mb-4">
                            <p class="text-sm sm:text-base recipient-sender-text">To. <span id="previewRecipient" class="font-semibold postcard-content">ë°›ëŠ” ì‚¬ëŒ ì´ë¦„</span></p>
                        </div>
                        
                        <div class="text-center flex-grow py-2 px-1 relative">
                            <p id="previewMessage" class="text-slate-800 leading-relaxed postcard-content mb-3 sm:mb-4">ë”°ëœ»í•œ ì‚¬ë‘ì˜ ë©”ì‹œì§€ë¥¼ ì—¬ê¸°ì— ì ì–´ì£¼ì„¸ìš”...</p>
                            <p id="previewPromise" class="text-indigo-600 font-medium postcard-content mb-2"></p>
                        </div>
                        
                        <div class="mt-4 text-right">
                            <p class="text-sm sm:text-base recipient-sender-text">From. <span id="previewSender" class="font-semibold postcard-content">ë³´ë‚´ëŠ” ì‚¬ëŒ ì´ë¦„</span></p>
                            <p id="previewDate" class="text-xs text-slate-500 mt-1 postcard-content">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>
                        </div>
                    </div>
                </div>
                
                <!-- ì‚¬ìš© ë°©ë²• -->
                <div class="mt-4 sm:mt-6 p-3 sm:p-4 bg-blue-50 border-l-4 border-blue-400 text-blue-700 rounded-md shadow">
                    <p class="font-semibold text-sm sm:text-base mb-2 sm:mb-3">ğŸ“ ì‚¬ìš© ë°©ë²•</p>
                    <div class="space-y-1.5 sm:space-y-2 text-xs sm:text-sm">
                        <div class="flex items-center">
                            <span class="mr-2">ğŸŒ¸</span>
                            <strong>ê³„ì ˆ ì„ íƒ:</strong> ë´„(ê½ƒì), ì—¬ë¦„(íŒŒë„), ê°€ì„(ë‚™ì—½), ê²¨ìš¸(ëˆˆ) ì¤‘ ì›í•˜ëŠ” ê³„ì ˆ íš¨ê³¼ë¥¼ ì„ íƒí•˜ì„¸ìš”
                        </div>
                        <div class="flex items-center">
                            <span class="mr-2">âœï¸</span>
                            <strong>ë‚´ìš© ì…ë ¥:</strong> ë°›ëŠ” ì‚¬ëŒ, ë³´ë‚´ëŠ” ì‚¬ëŒ, ì‚¬ë‘ì˜ ë©”ì‹œì§€ë¥¼ ì ì–´ì£¼ì„¸ìš”
                        </div>
                        <div class="flex items-center">
                            <span class="mr-2">ğŸ¨</span>
                            <strong>ë¯¸ë¦¬ë³´ê¸°:</strong> ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ê³„ì ˆ ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜ ì—½ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”
                        </div>
                        <div class="flex items-center">
                            <span class="mr-2">ğŸ“¸</span>
                            <strong>ì €ì¥í•˜ê¸°:</strong> ì™„ì„±ëœ ì—½ì„œë¥¼ ì´ë¯¸ì§€ íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”
                        </div>
                    </div>
                    <div class="mt-3 p-2 bg-blue-100 rounded-md">
                        <p class="text-xs font-medium text-blue-800">
                            âœ¨ <strong>íŠ¹ë³„í•œ ê¸°ëŠ¥:</strong> ê° ê³„ì ˆë§ˆë‹¤ ê³ ìœ í•œ ë°°ê²½ ì• ë‹ˆë©”ì´ì…˜ì´ í…ìŠ¤íŠ¸ ë’¤ì—ì„œ ë¶€ë“œëŸ½ê²Œ ì›€ì§ì—¬ìš”! 
                            ê¸€ìëŠ” ì„ ëª…í•˜ê²Œ ë³´ì´ë©´ì„œ ë°°ê²½ì—ëŠ” ì•„ë¦„ë‹¤ìš´ ìì—° íš¨ê³¼ê°€ í¼ì³ì§‘ë‹ˆë‹¤.
                        </p>
                    </div>
                    <p class="text-xs mt-2 sm:mt-3 text-blue-600">
                        ğŸ’¡ <strong>íŒ:</strong> ì €ì¥ëœ ì´ë¯¸ì§€ëŠ” íŒ¨ë“¤ë ›ì´ë‚˜ í´ë˜ìŠ¤íŒ…ì— ë°”ë¡œ ì˜¬ë¦´ ìˆ˜ ìˆì–´ìš”!
                    </p>
                </div>
            </div>
        </div>
        
        <footer class="text-center mt-8 sm:mt-10 pt-4 sm:pt-6 border-t border-slate-200">
            <p class="text-xs sm:text-sm text-slate-500">ìŠ¤ë§ˆíŠ¸í¼ë¹Œë”ê°€ ì •ì„±ê» ë§Œë“¤ì–´ ë“œë ¸ì–´ìš”! ğŸ¤– | ê³„ì ˆë³„ ì• ë‹ˆë©”ì´ì…˜ + Tailwind CSS + html2canvas</p>
        </footer>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentSeason = 'spring';
        let animationIntervals = [];
        
        const recipientInput = document.getElementById('recipient');
        const senderInput = document.getElementById('sender');
        const messageInput = document.getElementById('message');
        const promiseInput = document.getElementById('promise');
        const dateInput = document.getElementById('date');

        const postcardPreview = document.getElementById('postcardPreview');
        const previewRecipient = document.getElementById('previewRecipient');
        const previewSender = document.getElementById('previewSender');
        const previewMessage = document.getElementById('previewMessage');
        const previewPromise = document.getElementById('previewPromise');
        const previewDate = document.getElementById('previewDate');
        const previewThemeIcon = document.getElementById('previewThemeIcon');

        const seasonSpringButton = document.getElementById('seasonSpring');
        const seasonSummerButton = document.getElementById('seasonSummer');
        const seasonAutumnButton = document.getElementById('seasonAutumn');
        const seasonWinterButton = document.getElementById('seasonWinter');
        
        const updatePreviewButton = document.getElementById('updatePreview');
        const downloadImageBtn = document.getElementById('downloadImageBtn');
        const copyContentButton = document.getElementById('copyContent');
        const resetFormButton = document.getElementById('resetForm');
        const statusMessages = document.getElementById('status-messages');

        // ì• ë‹ˆë©”ì´ì…˜ ì»¨í…Œì´ë„ˆë“¤
        const springPetals = document.getElementById('springPetals');
        const summerWaves = document.getElementById('summerWaves');
        const autumnLeaves = document.getElementById('autumnLeaves');
        const winterSnow = document.getElementById('winterSnow');

        // ì ‘ê·¼ì„± - ìŠ¤í¬ë¦° ë¦¬ë”ì— ë©”ì‹œì§€ ì „ë‹¬
        function announceToScreenReader(message) {
            statusMessages.textContent = message;
            setTimeout(() => {
                statusMessages.textContent = '';
            }, 1000);
        }

        // ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ ì •ë¦¬
        function clearAllAnimations() {
            animationIntervals.forEach(interval => clearInterval(interval));
            animationIntervals = [];
            springPetals.innerHTML = '';
            summerWaves.innerHTML = '';
            autumnLeaves.innerHTML = '';
            winterSnow.innerHTML = '';
            
            // ëª¨ë“  ì• ë‹ˆë©”ì´ì…˜ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
            springPetals.style.display = 'none';
            summerWaves.style.display = 'none';
            autumnLeaves.style.display = 'none';
            winterSnow.style.display = 'none';
        }

        // ğŸŒ¸ ë´„ - ê½ƒì í©ë‚ ë¦¬ê¸° ì• ë‹ˆë©”ì´ì…˜
        function startSpringAnimation() {
            clearAllAnimations();
            springPetals.style.display = 'block';
            
            const createPetal = () => {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.style.left = Math.random() * 100 + '%';
                petal.style.animationDuration = (Math.random() * 3 + 4) + 's';
                petal.style.animationDelay = Math.random() * 2 + 's';
                springPetals.appendChild(petal);
                
                setTimeout(() => {
                    if (petal.parentNode) {
                        petal.parentNode.removeChild(petal);
                    }
                }, 7000);
            };
            
            // ì´ˆê¸° ê½ƒìë“¤ ìƒì„±
            for (let i = 0; i < 6; i++) {
                setTimeout(createPetal, i * 500);
            }
            
            // ì§€ì†ì ìœ¼ë¡œ ê½ƒì ìƒì„±
            const interval = setInterval(createPetal, 1500);
            animationIntervals.push(interval);
        }

        // ğŸŒŠ ì—¬ë¦„ - íŒŒë„ ì• ë‹ˆë©”ì´ì…˜
        function startSummerAnimation() {
            clearAllAnimations();
            summerWaves.style.display = 'block';
            
            const createWave = (delay) => {
                const wave = document.createElement('div');
                wave.className = 'wave';
                wave.style.animationDuration = '4s';
                wave.style.animationDelay = delay + 's';
                summerWaves.appendChild(wave);
            };
            
            // ì—¬ëŸ¬ ê°œì˜ íŒŒë„ ìƒì„±
            createWave(0);
            createWave(1);
            createWave(2);
        }

        // ğŸ‚ ê°€ì„ - ë‚™ì—½ ë–¨ì–´ì§€ê¸° ì• ë‹ˆë©”ì´ì…˜
        function startAutumnAnimation() {
            clearAllAnimations();
            autumnLeaves.style.display = 'block';
            
            const leafEmojis = ['ğŸ‚', 'ğŸ', 'ğŸŒ¿'];
            const leafColors = ['#ea580c', '#dc2626', '#ca8a04'];
            
            const createLeaf = () => {
                const leaf = document.createElement('div');
                leaf.className = 'leaf';
                const leafType = Math.random();
                
                if (leafType < 0.7) {
                    leaf.textContent = leafEmojis[Math.floor(Math.random() * leafEmojis.length)];
                } else {
                    leaf.innerHTML = 'â—';
                    leaf.style.color = leafColors[Math.floor(Math.random() * leafColors.length)];
                    leaf.style.fontSize = '12px';
                }
                
                leaf.style.left = Math.random() * 100 + '%';
                leaf.style.animationDuration = (Math.random() * 3 + 5) + 's';
                leaf.style.animationDelay = Math.random() * 2 + 's';
                autumnLeaves.appendChild(leaf);
                
                setTimeout(() => {
                    if (leaf.parentNode) {
                        leaf.parentNode.removeChild(leaf);
                    }
                }, 8000);
            };
            
            // ì´ˆê¸° ë‚™ì—½ë“¤ ìƒì„±
            for (let i = 0; i < 5; i++) {
                setTimeout(createLeaf, i * 600);
            }
            
            // ì§€ì†ì ìœ¼ë¡œ ë‚™ì—½ ìƒì„±
            const interval = setInterval(createLeaf, 2000);
            animationIntervals.push(interval);
        }

        // â„ï¸ ê²¨ìš¸ - ëˆˆ ë‚´ë¦¬ê¸° ì• ë‹ˆë©”ì´ì…˜
        function startWinterAnimation() {
            clearAllAnimations();
            winterSnow.style.display = 'block';
            
            const snowflakeChars = ['â„', 'â…', 'âœ¦', 'âœ§', 'â—¦'];
            
            const createSnowflake = () => {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.textContent = snowflakeChars[Math.floor(Math.random() * snowflakeChars.length)];
                snowflake.style.left = Math.random() * 100 + '%';
                snowflake.style.fontSize = (Math.random() * 6 + 10) + 'px';
                snowflake.style.animationDuration = (Math.random() * 4 + 6) + 's';
                snowflake.style.animationDelay = Math.random() * 2 + 's';
                winterSnow.appendChild(snowflake);
                
                setTimeout(() => {
                    if (snowflake.parentNode) {
                        snowflake.parentNode.removeChild(snowflake);
                    }
                }, 10000);
            };
            
            // ì´ˆê¸° ëˆˆì†¡ì´ë“¤ ìƒì„±
            for (let i = 0; i < 8; i++) {
                setTimeout(createSnowflake, i * 400);
            }
            
            // ì§€ì†ì ìœ¼ë¡œ ëˆˆì†¡ì´ ìƒì„±
            const interval = setInterval(createSnowflake, 1200);
            animationIntervals.push(interval);
        }

        // ê³„ì ˆ í…Œë§ˆ ì ìš©
        function applySeason(season) {
            currentSeason = season;
            
            // ê¸°ì¡´ ê³„ì ˆ í´ë˜ìŠ¤ ì œê±°
            postcardPreview.classList.remove('season-spring', 'season-summer', 'season-autumn', 'season-winter');
            
            // ê³„ì ˆë³„ ì„¤ì •
            const seasonConfigs = {
                spring: {
                    class: 'season-spring',
                    icon: 'ğŸŒ¸',
                    textClass: 'text-pink-700',
                    animation: startSpringAnimation
                },
                summer: {
                    class: 'season-summer',
                    icon: 'ğŸŒŠ',
                    textClass: 'text-blue-700',
                    animation: startSummerAnimation
                },
                autumn: {
                    class: 'season-autumn',
                    icon: 'ğŸ‚',
                    textClass: 'text-orange-700',
                    animation: startAutumnAnimation
                },
                winter: {
                    class: 'season-winter',
                    icon: 'â„ï¸',
                    textClass: 'text-gray-700',
                    animation: startWinterAnimation
                }
            };
            
            const config = seasonConfigs[season];
            postcardPreview.classList.add(config.class);
            previewThemeIcon.textContent = config.icon;
            
            // í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
            const textElements = postcardPreview.querySelectorAll('.recipient-sender-text');
            textElements.forEach(el => {
                el.classList.remove('text-pink-700', 'text-blue-700', 'text-orange-700', 'text-gray-700');
                el.classList.add(config.textClass);
            });
            
            // ê³„ì ˆ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.season-option').forEach(btn => btn.classList.remove('selected'));
            document.querySelector(`[data-season="${season}"]`).classList.add('selected');
            
            // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
            config.animation();
            
            announceToScreenReader(`${config.icon} ${season} í…Œë§ˆê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        function setTodayDate() {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            dateInput.value = `${yyyy}-${mm}-${dd}`;
        }

        function updatePostcardPreview() {
            previewRecipient.textContent = recipientInput.value || 'ë°›ëŠ” ì‚¬ëŒ ì´ë¦„';
            previewSender.textContent = senderInput.value || 'ë³´ë‚´ëŠ” ì‚¬ëŒ ì´ë¦„';
            previewMessage.textContent = messageInput.value || 'ë”°ëœ»í•œ ì‚¬ë‘ì˜ ë©”ì‹œì§€ë¥¼ ì—¬ê¸°ì— ì ì–´ì£¼ì„¸ìš”...';
            previewPromise.textContent = promiseInput.value ? `ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ì‹¤ì²œ ì•½ì†: ${promiseInput.value}` : '';
            
            const dateValue = dateInput.value;
            if (dateValue) {
                const [year, month, day] = dateValue.split('-');
                previewDate.textContent = `${year}ë…„ ${month}ì›” ${day}ì¼`;
            } else {
                previewDate.textContent = 'ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
            }
            
            adjustTextSizeBasedOnContent();
            announceToScreenReader('ì—½ì„œ ë‚´ìš©ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function adjustTextSizeBasedOnContent() {
            const messageLength = messageInput.value.length;
            const promiseLength = promiseInput.value.length;
            const isMobile = window.innerWidth < 640;
            
            previewMessage.classList.remove('text-lg', 'text-base', 'text-sm', 'text-xs');
            if (isMobile) {
                if (messageLength > 150) {
                    previewMessage.classList.add('text-xs');
                } else if (messageLength > 80) {
                    previewMessage.classList.add('text-sm');
                } else if (messageLength > 40) {
                    previewMessage.classList.add('text-base');
                } else {
                    previewMessage.classList.add('text-base');
                }
            } else {
                if (messageLength > 200) {
                    previewMessage.classList.add('text-xs');
                } else if (messageLength > 120) {
                    previewMessage.classList.add('text-sm');
                } else if (messageLength > 60) {
                    previewMessage.classList.add('text-base');
                } else {
                    previewMessage.classList.add('text-lg');
                }
            }
            
            previewPromise.classList.remove('text-base', 'text-sm', 'text-xs');
            if (isMobile) {
                if (promiseLength > 60) {
                    previewPromise.classList.add('text-xs');
                } else if (promiseLength > 30) {
                    previewPromise.classList.add('text-sm');
                } else {
                    previewPromise.classList.add('text-sm');
                }
            } else {
                if (promiseLength > 100) {
                    previewPromise.classList.add('text-xs');
                } else if (promiseLength > 50) {
                    previewPromise.classList.add('text-sm');
                } else {
                    previewPromise.classList.add('text-base');
                }
            }
        }

        // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
        async function downloadPostcardAsImage() {
            const originalText = downloadImageBtn.innerHTML;
            downloadImageBtn.innerHTML = '<span class="mr-2">â³</span>ì´ë¯¸ì§€ ìƒì„± ì¤‘...';
            downloadImageBtn.disabled = true;
            downloadImageBtn.classList.add('loading');
            
            announceToScreenReader('ì—½ì„œ ì´ë¯¸ì§€ ìƒì„±ì„ ì‹œì‘í•©ë‹ˆë‹¤.');
            
            try {
                if (typeof html2canvas === 'undefined') {
                    throw new Error('ì´ë¯¸ì§€ ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                }
                
                updatePostcardPreview();
                await new Promise(resolve => setTimeout(resolve, 500));
                
                if (!postcardPreview || postcardPreview.offsetWidth === 0) {
                    throw new Error('ì—½ì„œë¥¼ ë¨¼ì € í™•ì¸í•´ì£¼ì„¸ìš”. ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }

                const canvas = await html2canvas(postcardPreview, { 
                    scale: 2,
                    useCORS: true, 
                    allowTaint: false,
                    logging: false,
                    backgroundColor: '#ffffff',
                    width: postcardPreview.offsetWidth,
                    height: postcardPreview.offsetHeight,
                    scrollX: 0,
                    scrollY: 0,
                    letterRendering: true,
                    imageTimeout: 15000,
                    removeContainer: true,
                    onclone: function(clonedDoc) {
                        const srOnlyElements = clonedDoc.querySelectorAll('.sr-only');
                        srOnlyElements.forEach(el => el.remove());
                        
                        const clonedPreview = clonedDoc.getElementById('postcardPreview');
                        if (clonedPreview) {
                            clonedPreview.style.height = 'auto';
                            clonedPreview.style.minHeight = postcardPreview.offsetHeight + 'px';
                            clonedPreview.style.overflow = 'visible';
                            clonedPreview.style.fontFamily = '-apple-system, BlinkMacSystemFont, "Malgun Gothic", "ë§‘ì€ ê³ ë”•", "Apple SD Gothic Neo", sans-serif';
                            
                            const allElements = clonedPreview.querySelectorAll('*');
                            allElements.forEach(el => {
                                el.style.fontFamily = '-apple-system, BlinkMacSystemFont, "Malgun Gothic", "ë§‘ì€ ê³ ë”•", "Apple SD Gothic Neo", sans-serif';
                            });
                        }
                        
                        return clonedDoc;
                    }
                });
                
                if (canvas.width === 0 || canvas.height === 0) {
                    throw new Error('ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì—˜ë¦¬ë¨¼íŠ¸ê°€ ì œëŒ€ë¡œ í‘œì‹œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                const imgData = canvas.toDataURL('image/png', 1.0);
                
                if (imgData === 'data:,' || imgData.length < 100) {
                    throw new Error('ì´ë¯¸ì§€ ë°ì´í„° ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                
                const recipientName = recipientInput.value || 'ê°€ì¡±';
                const fileName = `${recipientName.replace(/[^\wê°€-í£ã„±-ã…ã…-ã…£ä¸€-é¾ ã-ã‚”ã‚¡-ãƒ´ãƒ¼]/g, '_')}_ê³„ì ˆì—½ì„œ_${currentSeason}.png`;
                
                const downloadLink = document.createElement('a');
                downloadLink.href = imgData;
                downloadLink.download = fileName;
                downloadLink.style.display = 'none';
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                announceToScreenReader('ì—½ì„œ ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                alert(`ğŸ‰ ${currentSeason} í…Œë§ˆ ì—½ì„œ ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\nì•„ë¦„ë‹¤ìš´ ê³„ì ˆ ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥ë˜ì—ˆì–´ìš”.`);
                
            } catch (error) {
                console.error("ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜:", error);
                
                let errorMessage = "ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n";
                
                if (error.message.includes('ë¼ì´ë¸ŒëŸ¬ë¦¬')) {
                    errorMessage += "í•´ê²° ë°©ë²•: í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë¸Œë¼ìš°ì €ì—ì„œ ì‹œë„í•´ë³´ì„¸ìš”.";
                } else if (error.message.includes('ì—˜ë¦¬ë¨¼íŠ¸')) {
                    errorMessage += "í•´ê²° ë°©ë²•: 'ì—½ì„œ í™•ì¸í•˜ê¸°' ë²„íŠ¼ì„ ë¨¼ì € ëˆŒëŸ¬ ë¯¸ë¦¬ë³´ê¸°ë¥¼ í™•ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.";
                } else {
                    errorMessage += "í•´ê²° ë°©ë²•:\n";
                    errorMessage += "1. 'ì—½ì„œ í™•ì¸í•˜ê¸°' ë²„íŠ¼ì„ ë¨¼ì € í´ë¦­í•´ì£¼ì„¸ìš”\n";
                    errorMessage += "2. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”\n";
                    errorMessage += "3. ë‹¤ë¥¸ ë¸Œë¼ìš°ì €(Chrome, Edge ë“±)ë¥¼ ì‚¬ìš©í•´ë³´ì„¸ìš”";
                }
                
                alert(errorMessage);
                announceToScreenReader('ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                downloadImageBtn.innerHTML = originalText;
                downloadImageBtn.disabled = false;
                downloadImageBtn.classList.remove('loading');
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        setTodayDate();
        updatePostcardPreview();

        updatePreviewButton.addEventListener('click', updatePostcardPreview);
        downloadImageBtn.addEventListener('click', downloadPostcardAsImage);
        
        // ê³„ì ˆ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
        seasonSpringButton.addEventListener('click', () => applySeason('spring'));
        seasonSummerButton.addEventListener('click', () => applySeason('summer'));
        seasonAutumnButton.addEventListener('click', () => applySeason('autumn'));
        seasonWinterButton.addEventListener('click', () => applySeason('winter'));

        copyContentButton.addEventListener('click', () => {
            const dateValue = dateInput.value;
            let formattedDate = 'ë‚ ì§œ ë¯¸ì§€ì •';
            if (dateValue) {
                const [year, month, day] = dateValue.split('-');
                formattedDate = `${year}ë…„ ${month}ì›” ${day}ì¼`;
            }

            const seasonNames = {
                spring: 'ë´„ (ê½ƒì í©ë‚ ë¦¼)',
                summer: 'ì—¬ë¦„ (íŒŒë„ ì›€ì§ì„)',
                autumn: 'ê°€ì„ (ë‚™ì—½ ë–¨ì–´ì§)',
                winter: 'ê²¨ìš¸ (ëˆˆ ë‚´ë¦¼)'
            };

            const contentToCopy = `
ê³„ì ˆ ê°€ì¡± ì‚¬ë‘ ì—½ì„œ â¤ï¸
--------------------
ë°›ëŠ” ì‚¬ëŒ: ${recipientInput.value}
ë³´ë‚´ëŠ” ì‚¬ëŒ: ${senderInput.value}
ì‘ì„± ë‚ ì§œ: ${formattedDate}
ì„ íƒí•œ ê³„ì ˆ: ${seasonNames[currentSeason]}

[ì‚¬ë‘ì˜ ë©”ì‹œì§€]
${messageInput.value}

[ê°€ì¡±ì„ ìœ„í•œ ë‚˜ì˜ ì•½ì†]
${promiseInput.value}
--------------------
`.trim();

            navigator.clipboard.writeText(contentToCopy)
                .then(() => {
                    alert('ì—½ì„œ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆì–´ìš”! ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”. (Ctrl+V ë˜ëŠ” Cmd+V)');
                    announceToScreenReader('ì—½ì„œ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                })
                .catch(err => {
                    console.error('ë³µì‚¬ ì‹¤íŒ¨: ', err);
                    alert('ì•—! ë‚´ìš© ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•˜ê±°ë‚˜ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                });
        });

        resetFormButton.addEventListener('click', () => {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ë‚´ìš©ì„ ì§€ìš°ê³  ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‘ì„±í• ê¹Œìš”?')) {
                recipientInput.value = '';
                senderInput.value = '';
                messageInput.value = '';
                promiseInput.value = '';
                setTodayDate();
                
                applySeason('spring');
                updatePostcardPreview();
                alert('ëª¨ë“  ë‚´ìš©ì´ ì§€ì›Œì¡Œì–´ìš”. ìƒˆë¡œìš´ ë§ˆìŒìœ¼ë¡œ ì—½ì„œë¥¼ ë‹¤ì‹œ ì‘ì„±í•´ë³´ì„¸ìš”! ğŸ˜Š');
                announceToScreenReader('ì–‘ì‹ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        });

        // ì´ˆê¸° ì„¤ì •
        applySeason('spring');
        
        // í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ í…ìŠ¤íŠ¸ í¬ê¸° ì¬ì¡°ì •
        window.addEventListener('resize', adjustTextSizeBasedOnContent);
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì• ë‹ˆë©”ì´ì…˜ ì •ë¦¬
        window.addEventListener('beforeunload', clearAllAnimations);
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì•Œë¦¼
        announceToScreenReader('ê³„ì ˆë³„ ì• ë‹ˆë©”ì´ì…˜ ê°€ì¡± ì‚¬ë‘ ì—½ì„œ ë§Œë“¤ê¸° í˜ì´ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
    </script>
</body>
</html>
